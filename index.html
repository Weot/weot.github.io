<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"wangmaio.site","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.15.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="大喵小站">
<meta property="og:url" content="https://wangmaio.site/index.html">
<meta property="og:site_name" content="大喵小站">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Wang Miao">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://wangmaio.site/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>大喵小站</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">大喵小站</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">种一棵树最好的时间是十年前, 其次是现在</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wang Miao"
      src="/images/logo.png">
  <p class="site-author-name" itemprop="name">Wang Miao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/weot" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;weot" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/1575566554" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;1575566554" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/15/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-openEuler%E4%B8%8Bflask%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/15/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-openEuler%E4%B8%8Bflask%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">openEuler下flask服务器环境搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-07-15 21:24:00 / 修改时间：21:48:00" itemprop="dateCreated datePublished" datetime="2024-07-15T21:24:00+08:00">2024-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">编程开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Linux-openEular-下Flask开发环境搭建"><a href="#Linux-openEular-下Flask开发环境搭建" class="headerlink" title="Linux(openEular) 下Flask开发环境搭建"></a>Linux(openEular) 下Flask开发环境搭建</h1><h2 id="Linux-本体"><a href="#Linux-本体" class="headerlink" title="Linux 本体"></a>Linux 本体</h2><h2 id="虚拟机安装-openEuler"><a href="#虚拟机安装-openEuler" class="headerlink" title="虚拟机安装[[openEuler]]"></a>虚拟机安装[[openEuler]]</h2><h2 id="使用Windows命令行ssh登录虚拟机内系统"><a href="#使用Windows命令行ssh登录虚拟机内系统" class="headerlink" title="使用Windows命令行ssh登录虚拟机内系统"></a>使用Windows命令行ssh登录虚拟机内系统</h2><h3 id="ssh-用户名密码形式登录"><a href="#ssh-用户名密码形式登录" class="headerlink" title="ssh 用户名密码形式登录"></a>ssh 用户名密码形式登录</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> username@192.168.101.131<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>类似登录操作需要每次输入密码</p>
<h3 id="使用ssh-key登录"><a href="#使用ssh-key登录" class="headerlink" title="使用ssh key登录"></a>使用ssh key登录</h3><ol>
<li><p>本地生成密钥文件</p>
 <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-keygen <span class="token parameter variable">-t</span> rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p> 这一步会在<code>~/.ssh/</code>目录下生成公钥和私钥文件</p>
</li>
<li><p>将<code>~/.ssh/</code>下的公钥文件<code>id_rsa.pub</code>复制到远程服务器</p>
</li>
</ol>
<pre><code><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">ssh-copy-id -i ~&#x2F;.ssh&#x2F;id_rsa.pub miao@192.168.101.131<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

成功后, 可以在尝试登录, 现在就不需要输入密码了
</code></pre>
<h3 id="vscode-ssh登录"><a href="#vscode-ssh登录" class="headerlink" title="vscode ssh登录"></a>vscode ssh登录</h3><p>可能会遇到错误, <code>tar</code>命令不存在</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum installl <span class="token function">tar</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>连接后, 长时间显示正在连接, 可能需要再服务器修改一项设置</p>
<p>修改<code>/etc/ssh/sshd_config</code>文件, 取消对应行注释</p>
<pre class="line-numbers language-config" data-language="config"><code class="language-config">AllowTCPForwarding yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="安装Python-virtualenv虚拟环境"><a href="#安装Python-virtualenv虚拟环境" class="headerlink" title="安装Python virtualenv虚拟环境"></a>安装Python virtualenv虚拟环境</h2><p>安装前配置国内pip源(可选)</p>
<p><code>pip.conf</code>文件(使用阿里源, 大公司的速动更快一点)</p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">global</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">index-url</span> <span class="token punctuation">=</span> <span class="token value attr-value">https://mirrors.aliyun.com/pypi/simple/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>编辑环境变量文件, 设置环境变量<code>PIP_CONFIG_FILE</code>指向<code>pip.conf</code>文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vi</span> /etc/profile.d/pip.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">PIP_CONFIG_FILE</span><span class="token operator">=</span>/home/miao/.conf/pip.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="uWsgi-安装与配置"><a href="#uWsgi-安装与配置" class="headerlink" title="uWsgi 安装与配置"></a>uWsgi 安装与配置</h2><p><code>uWsgi</code> 安装过程没有太多坑, <code>pip install uwsgi</code>一般会遇到一些问题, 编译错误的根据提示下载<code>gcc</code>或者<code>python3-dev</code>之类的就可以解决</p>
<h3 id="uWsgi-配置文件"><a href="#uWsgi-配置文件" class="headerlink" title="uWsgi 配置文件"></a>uWsgi 配置文件</h3><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">uwsgi</span><span class="token punctuation">]</span></span>
<span class="token comment">#uwsgi启动时，所使用的地址和端口（这个是http协议的）</span>
<span class="token comment">#http=0.0.0.0:5000</span>
<span class="token comment">#指向网站目录</span>
<span class="token key attr-name">chdir</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/myexam/</span>
<span class="token comment">#python 启动程序文件</span>
<span class="token key attr-name">wsgi-file</span><span class="token punctuation">=</span><span class="token value attr-value">wsgi.py</span>
<span class="token comment">#python 程序内用以启动的application 变量名</span>
<span class="token key attr-name">callable</span><span class="token punctuation">=</span><span class="token value attr-value">app</span>
<span class="token comment">#处理器数</span>
<span class="token key attr-name">processes</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
<span class="token comment">#线程数</span>
<span class="token key attr-name">threads</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
<span class="token comment"># uwsgi pid 号</span>
<span class="token key attr-name">pidfile</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/uwsgi/uwsgi.pid</span>

<span class="token comment"># 重启的时候使用的 pid 号</span>
<span class="token key attr-name">touch-reload</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/uwsgi/uwsgi.pid</span>

<span class="token comment"># unix socket和TCP socket配置, 在nginx可以使用这两个socket</span>
<span class="token key attr-name">socket</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/uwsgi/uwsgi.sock</span>
<span class="token key attr-name">socket</span><span class="token punctuation">=</span><span class="token value attr-value">0.0.0.0:5000</span>
<span class="token key attr-name">chomod-socket</span><span class="token punctuation">=</span><span class="token value attr-value">666</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="uWsgi-开机启动"><a href="#uWsgi-开机启动" class="headerlink" title="uWsgi 开机启动"></a>uWsgi 开机启动</h3><p>添加配置文件<code>/etc/systemd/system/uwsgi.service</code></p>
<pre class="line-numbers language-service" data-language="service"><code class="language-service">[Unit]
Description&#x3D;uwsgi
After&#x3D;syslog.target

[Service]
Type&#x3D;notify
ExecStart&#x3D;&#x2F;home&#x2F;miao&#x2F;.venv&#x2F;myflask&#x2F;bin&#x2F;uwsgi --ini &#x2F;home&#x2F;miao&#x2F;uwsgi&#x2F;uwsgi.ini
ExecStop&#x3D;&#x2F;home&#x2F;miao&#x2F;.venv&#x2F;myflask&#x2F;bin&#x2F;uwsgi --stop &#x2F;home&#x2F;miao&#x2F;uwsgi&#x2F;uwsgi.pid
ExecReload&#x3D;&#x2F;home&#x2F;miao&#x2F;.venv&#x2F;myflask&#x2F;bin&#x2F;uwsgi --reload &#x2F;home&#x2F;miao&#x2F;uwsgi&#x2F;uwsgi.pid
User&#x3D;miao
Group&#x3D;miao
Restart&#x3D;on-failure
KillSignal&#x3D;SIGQUIT
StandardError&#x3D;syslog
NotifyAccess&#x3D;all
[Install]
WantedBy&#x3D;multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>配置好后, 使用下面命令重新加载</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>启动<code>uwsgi</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start uwsgi <span class="token comment"># 启动</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> uwsgi <span class="token comment"># 开机自启</span>
<span class="token function">sudo</span> systemctl stop uwsgi <span class="token comment"># 关闭</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<h2 id="nginx-安装与配置"><a href="#nginx-安装与配置" class="headerlink" title="nginx 安装与配置"></a>nginx 安装与配置</h2><h3 id="nginx-自身配置"><a href="#nginx-自身配置" class="headerlink" title="nginx 自身配置"></a>nginx 自身配置</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>安装一般没有太大问题</p>
<p>现在开启<code>nginx</code>服务</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>想要使服务开机自启, 可以使用下面命令</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在可以在本机浏览器打开虚拟机服务器IP(比如<code>192.168.101.131</code>), 测试下是否安装成功</p>
<img src="/2024/07/15/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-openEuler%E4%B8%8Bflask%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/nginx%E6%AC%A2%E8%BF%8E%E9%A1%B5%E9%9D%A2.jpg" class="" title="nginx欢迎页面">

<p>安装成功, 应该可以看到上述欢迎页面</p>
<p>如果打不开, 可能是防火墙问题, 为了测试方便, 可以关闭防火墙</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl stop firewalld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="nginx-代理uwsgi配置"><a href="#nginx-代理uwsgi配置" class="headerlink" title="nginx 代理uwsgi配置"></a>nginx 代理uwsgi配置</h3><p><code>Nginx</code>中相应配置, 文件位置一般在<code>/etc/nginx/nginx.conf</code>:</p>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">&#123;</span>
...
    <span class="token directive"><span class="token keyword">upstream</span> flask</span> <span class="token punctuation">&#123;</span>
        <span class="token comment"># 使用uwsgi的unix socket接口进行通信</span>
        <span class="token directive"><span class="token keyword">server</span> unix:///home/miao/uwsgi/uwsgi.sock</span><span class="token punctuation">;</span>
        <span class="token comment"># server 0.0.0.0:5000;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">&#123;</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">listen</span>       [::]:80</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  _</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">root</span>         /usr/share/nginx/html</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">charset</span> utf-8</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">&#123;</span>
            <span class="token directive"><span class="token keyword">include</span> uwsgi_params</span><span class="token punctuation">;</span>
            <span class="token comment"># 指定上面的upstream</span>
            <span class="token directive"><span class="token keyword">uwsgi_pass</span> flask</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

...
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="其他工具类配置"><a href="#其他工具类配置" class="headerlink" title="其他工具类配置"></a>其他工具类配置</h2><h3 id="服务器使用Jupyter-notebook-lab配置"><a href="#服务器使用Jupyter-notebook-lab配置" class="headerlink" title="服务器使用Jupyter notebook/lab配置"></a>服务器使用Jupyter notebook/lab配置</h3><h4 id="1-生成哈希密码"><a href="#1-生成哈希密码" class="headerlink" title="1. 生成哈希密码"></a>1. 生成哈希密码</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">jupyter server password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>miao@localhost ~<span class="token punctuation">]</span>$ jupyter server password
Enter password:
Verify password:
<span class="token punctuation">[</span>JupyterPasswordApp<span class="token punctuation">]</span> Wrote hashed password to /home/miao/.jupyter/jupyter_server_config.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到<code>~/.jupyter/lab/jupyter_server_config.json</code>文件中已经生产了hashed密码</p>
<h4 id="2-生成配置Jupyter配置文件"><a href="#2-生成配置Jupyter配置文件" class="headerlink" title="2. 生成配置Jupyter配置文件"></a>2. 生成配置Jupyter配置文件</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">jupyter server --generate-config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可以看到<code>~/.jupyter/lab/</code>文件夹下生成了<code>jupyter_server_config.py</code>配置文件</p>
<p>修改允许的IP访问</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">## The IP address the Jupyter server will listen on.</span>
<span class="token comment">#  Default: 'localhost'</span>
c<span class="token punctuation">.</span>ServerApp<span class="token punctuation">.</span>ip <span class="token operator">=</span> <span class="token string">'*'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>设置需要密码访问</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">## DEPRECATED in 2.0. Use PasswordIdentityProvider.password_required</span>
<span class="token comment">#  Default: False</span>
c<span class="token punctuation">.</span>ServerApp<span class="token punctuation">.</span>password_required <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>启动<code>jupyter lab</code>, 提示</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log"><span class="token punctuation">[</span>C <span class="token date number">2023-10-11</span> <span class="token time number">10:16:43.692</span> ServerApp<span class="token punctuation">]</span> Jupyter servers are configured to only be run with a password<span class="token punctuation">.</span>
<span class="token punctuation">[</span>C <span class="token date number">2023-10-11</span> <span class="token time number">10:16:43.692</span> ServerApp<span class="token punctuation">]</span> <span class="token property">Hint:</span> run the following command to set a password
<span class="token punctuation">[</span>C <span class="token date number">2023-10-11</span> <span class="token time number">10:16:43.692</span> ServerApp<span class="token punctuation">]</span>   <span class="token operator">$</span> python <span class="token operator">-</span>m jupyter_server<span class="token punctuation">.</span>auth password<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>根据提示使用<code>python -m jupyter_server.auth password</code>命令生成密码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token parameter variable">-m</span> jupyter_server.auth password
Provide password:
Repeat password:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>生成密码后, <code>jupyter_server_config.json</code>文件中会生成对应的hash密码</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"ServerApp"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"argon2:$argon2id$v=19$m=10240,t=10,p=8$a4Fqaw5Q3cGewI0eBol7ig$C+0C8NB0DUX2uiMxCCt1e3IVb4yty28ZXgluDknrJGE"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>此时, 再开启<code>jupyter lab</code>就可以使用密码访问了</p>
<h4 id="3-将Jupyter-lab设置为服务项目-并开机启动"><a href="#3-将Jupyter-lab设置为服务项目-并开机启动" class="headerlink" title="3. 将Jupyter lab设置为服务项目, 并开机启动"></a>3. 将Jupyter lab设置为服务项目, 并开机启动</h4><p>在<code>/etc/systemd/system/</code>文件下生成<code>jupyter.service</code>文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vi</span> /etc/systemd/system/jupyter.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>文件内容如下:</p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Unit</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Description</span><span class="token punctuation">=</span><span class="token value attr-value">Jupyterlab</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">network.target</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Service</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Type</span><span class="token punctuation">=</span><span class="token value attr-value">simple</span>
<span class="token key attr-name">ExecStart</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/.venv/exam/bin/jupyter-lab --config=/home/miao/.jupyter/jupyter_server_config.py --no-browser</span>
<span class="token key attr-name">User</span><span class="token punctuation">=</span><span class="token value attr-value">miao</span>
<span class="token key attr-name">Group</span><span class="token punctuation">=</span><span class="token value attr-value">miao</span>
<span class="token key attr-name">WorkingDirectory</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/myexam/</span>
<span class="token key attr-name">Restart</span><span class="token punctuation">=</span><span class="token value attr-value">always</span>
<span class="token key attr-name">RestartSec</span><span class="token punctuation">=</span><span class="token value attr-value">10</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Install</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">WantedBy</span><span class="token punctuation">=</span><span class="token value attr-value">multi-user.target</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>启动jupyter服务</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start jupyter<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>设置开机启动</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> jupyter<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="关于system-service无法读取自定义环境变量的问题"><a href="#关于system-service无法读取自定义环境变量的问题" class="headerlink" title="关于system service无法读取自定义环境变量的问题"></a>关于system service无法读取自定义环境变量的问题</h3><p>问题描述:</p>
<blockquote>
<p>用<code>systemctl</code>启动服务后, 无法读取<code>/etc/profile.d/*sh</code>中定义的环境变量</p>
</blockquote>
<p>暂时解决办法:</p>
<p>修改<code>uwsgi.service</code>和<code>jupyter.service</code>描述文件</p>
<p>在<code>[service]</code>部分添加<code>EnvironmentFile=/etc/profile.d/exam.env</code>指向新定义的环境变量文件</p>
<p><code>exam.env</code>文件中环境变量定义应该使用<code>key=value</code>的形式, 例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">MAIL_USERNAME</span><span class="token operator">=</span>admin@admin.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Nginx服务器日志文件无法查看问题"><a href="#Nginx服务器日志文件无法查看问题" class="headerlink" title="Nginx服务器日志文件无法查看问题"></a>Nginx服务器日志文件无法查看问题</h3><p>nginx服务器日志默认路径: <code>/var/log/nginx/</code><br>进入<code>/var/log/</code>, 可以看到<code>nginx</code>文件夹的所有者是用户<code>nginx</code>, 因为默认是<code>nginx</code>用户创建的, 可以通过nginx用户查看日志, 或者将<code>nginx/</code>文件夹的所有者改为当前用户</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> miao <span class="token parameter variable">-R</span> /var/log/nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="Nginx服务器上传文件失败"><a href="#Nginx服务器上传文件失败" class="headerlink" title="Nginx服务器上传文件失败"></a>Nginx服务器上传文件失败</h3><p>查看nginx日志文件:</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log"><span class="token date number">2023/10/27</span> <span class="token time number">11:29:33</span> <span class="token punctuation">[</span>crit<span class="token punctuation">]</span> <span class="token number">13286</span><span class="token operator">#</span><span class="token number">0</span><span class="token operator">:</span> <span class="token operator">*</span><span class="token number">1</span> open<span class="token operator">(</span><span class="token operator">)</span> <span class="token string">"/var/lib/nginx/tmp/client_body/0000000001"</span> <span class="token property">failed (13:</span> Permission denied<span class="token operator">)</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token ip-address constant">192.168.101.1</span><span class="token punctuation">,</span> server<span class="token operator">:</span> _<span class="token punctuation">,</span> request<span class="token operator">:</span> <span class="token string">"POST /add_chapters HTTP/1.1"</span><span class="token punctuation">,</span> host<span class="token operator">:</span> <span class="token string">"192.168.101.131"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可以看到<code>Permission denied</code>, 应该是权限问题, 这是因为上传到Nginx的文件要先保存在<code>/var/lib/nginx/tmp/</code>下, 查看后发现启动Nginx的用户无文件夹的读写权限</p>
<p>解决办法: </p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> miao <span class="token parameter variable">-R</span> /var/lib/nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>将文件夹的所有者改为启动Nginx的用户</p>
<h3 id="Git-服务器搭建与代码自动同步"><a href="#Git-服务器搭建与代码自动同步" class="headerlink" title="Git 服务器搭建与代码自动同步"></a>Git 服务器搭建与代码自动同步</h3><p>需求: 在openeuler服务器上搭建git服务器, 每次push提交后, 代码会自动同步到项目文件夹</p>
<h4 id="openEuler-上搭建git服务器"><a href="#openEuler-上搭建git服务器" class="headerlink" title="openEuler 上搭建git服务器"></a>openEuler 上搭建git服务器</h4><p>下载git</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">git</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>初始化git服务器目录</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> <span class="token function">git</span>
<span class="token builtin class-name">cd</span> <span class="token function">git</span>
<span class="token function">git</span> init <span class="token parameter variable">--bare</span> myexam.git<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>现在git目录下面就有一个裸git仓库</p>
<p>现在在本机, 将本地项目代码关联到这个远程仓库</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote set-url origin miao@192.168.1.169:~/git/myexam.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>查看远程仓库关联结果</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> remote <span class="token parameter variable">-v</span>
origin  miao@192.168.1.169:~/git/myexam.git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span>
origin  miao@192.168.1.169:~/git/myexam.git <span class="token punctuation">(</span>push<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>然后, 将本地代码推送到远程服务器</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> push<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在回到服务器, 将git仓库中的代码clone到我们需要打代码目录</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone ~/git/myexam.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="设置git提交后代码自动同步"><a href="#设置git提交后代码自动同步" class="headerlink" title="设置git提交后代码自动同步"></a>设置git提交后代码自动同步</h4><p>我们可以在服务器git仓库的hooks目录看到有许多可供调用的脚本文件, 这里我们使用post-update钩子, 里面是一些钩子文件的示例, 需要使用哪个, 就用去掉.sample后缀的格式</p>
<pre class="line-numbers language-none"><code class="language-none">total 60
-rwxr-xr-x. 1 miao miao  478 Nov 18 10:52 applypatch-msg.sample
-rwxr-xr-x. 1 miao miao  896 Nov 18 10:52 commit-msg.sample
-rwxr-xr-x. 1 miao miao 4655 Nov 18 10:52 fsmonitor-watchman.sample
-rwxr-xr-x. 1 miao miao  189 Nov 18 10:52 post-update.sample
-rwxr-xr-x. 1 miao miao  424 Nov 18 10:52 pre-applypatch.sample
-rwxr-xr-x. 1 miao miao 1643 Nov 18 10:52 pre-commit.sample
-rwxr-xr-x. 1 miao miao  416 Nov 18 10:52 pre-merge-commit.sample
-rwxr-xr-x. 1 miao miao 1492 Nov 18 10:52 prepare-commit-msg.sample
-rwxr-xr-x. 1 miao miao 1374 Nov 18 10:52 pre-push.sample
-rwxr-xr-x. 1 miao miao 4898 Nov 18 10:52 pre-rebase.sample
-rwxr-xr-x. 1 miao miao  544 Nov 18 10:52 pre-receive.sample
-rwxr-xr-x. 1 miao miao 2783 Nov 18 10:52 push-to-checkout.sample
-rwxr-xr-x. 1 miao miao 3650 Nov 18 10:52 update.sample<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们来设置下post-update脚本, 这个钩子将会在代码提交后自动调用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vi</span> ~/git/myexam.git/hooks/post-update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>post-update</code> 的内容</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token comment"># 打印输出</span>
<span class="token builtin class-name">echo</span> <span class="token string">'======上传代码到服务器======'</span>
<span class="token comment"># 打开线上项目文件夹</span>
<span class="token builtin class-name">cd</span> /home/miao/myexam
<span class="token comment"># 这个很重要，如果不取消的话将不能在cd的路径上进行git操作</span>
<span class="token builtin class-name">unset</span> GIT_DIR
<span class="token function">git</span> pull origin master
<span class="token comment"># 自动编译vue项目,如有需要请去掉前面的#号</span>
<span class="token comment"># npm run build</span>
<span class="token comment"># 自动更新composer（我暂时没试过）</span>
<span class="token comment"># composer update</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span><span class="token variable">)</span></span> <span class="token operator">>></span> hook.log
<span class="token builtin class-name">echo</span> <span class="token string">'======代码更新完成======'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>给<code>post-update</code> 文件加上可执行权限</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> +x ~/git/myexam.git/hooks/post-update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在可以提交代码, 测试下, 看是否可以同步</p>
<h3 id="openEuler-下-PostgreSql-安装"><a href="#openEuler-下-PostgreSql-安装" class="headerlink" title="openEuler 下 PostgreSql 安装"></a>openEuler 下 PostgreSql 安装</h3><h4 id="1-下载安装"><a href="#1-下载安装" class="headerlink" title="1. 下载安装"></a>1. 下载安装</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> postgresql-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="2-数据库初始配置"><a href="#2-数据库初始配置" class="headerlink" title="2. 数据库初始配置"></a>2. 数据库初始配置</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> postgresql-setup <span class="token parameter variable">--initdb</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>默认情况下pg已经默认创建了一个<code>postgres</code>Linux用户, 我们先为这个用户设置密码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">passwd</span> postgres<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>设置完毕后切换到<code>postgres</code>用户登录系统</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">su</span> - postgres <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>修改pg数据库用户<code>postgres</code>的密码, 之后我们可以用这个密码来连接pg数据库</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">psql <span class="token parameter variable">-d</span> template1 <span class="token parameter variable">-c</span> <span class="token string">"ALTER USER postgres WITH PASSWORD 'NewPassword';"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="3-配置PG数据库远程访问"><a href="#3-配置PG数据库远程访问" class="headerlink" title="3. 配置PG数据库远程访问"></a>3. 配置PG数据库远程访问</h3><p>修改配置文件<code>/var/lib/pgsql/data/postgresql.conf</code>文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vi</span> /var/lib/pgsql/data/postgresql.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>文件内容如下:</p>
<pre class="line-numbers language-conf" data-language="conf"><code class="language-conf">#------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#------------------------------------------------------------------------------

# - Connection Settings -

listen_addresses &#x3D; &#39;*&#39;          # what IP address(es) to listen on;
                                        # comma-separated list of addresses;
                                        # defaults to &#39;localhost&#39;; use &#39;*&#39; for all
                                        # (change requires restart)
port &#x3D; 5432                             # (change requires restart)
max_connections &#x3D; 100                   # (change requires restart)
#superuser_reserved_connections &#x3D; 3     # (change requires restart)
#unix_socket_directories &#x3D; &#39;&#x2F;var&#x2F;run&#x2F;postgresql, &#x2F;tmp&#39;  # comma-separated list of directories
                                        # (change requires restart)
#unix_socket_group &#x3D; &#39;&#39;                 # (change requires restart)
#unix_socket_permissions &#x3D; 0777         # begin with 0 to use octal notation
                                        # (change requires restart)
#bonjour &#x3D; off                          # advertise server via Bonjour
                                        # (change requires restart)
#bonjour_name &#x3D; &#39;&#39;                      # defaults to the computer name
                                        # (change requires restart)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>修改<code>listen_addresses = &#39;*&#39;</code>行, 监听所有IP, 并去掉注释</p>
<p>修改<code>port = 5432</code>, 可以更改端口号, 也可以不变, 但去掉前面注释</p>
<p>修改<code>/var/lib/pgsql/data/pg_hba.conf</code> 文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vi</span> /var/lib/pgsql/data/pg_hba.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>修改PG的访问规则</p>
<pre class="line-numbers language-conf" data-language="conf"><code class="language-conf"># TYPE  DATABASE        USER            ADDRESS                 METHOD

# &quot;local&quot; is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1&#x2F;32            ident
# IPv6 local connections:
host    all             all             ::1&#x2F;128                 ident
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     all                                     peer
#host    replication     all             127.0.0.1&#x2F;32            ident
#host    replication     all             ::1&#x2F;128                 ident
host    all     all             0.0.0.0&#x2F;0                 md5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注释掉原来的几条规则,  增加最后一行的规则</p>
<pre class="line-numbers language-conf" data-language="conf"><code class="language-conf">host    all     all             0.0.0.0&#x2F;0                 md5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在重启PG服务</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl restart postgresql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>重启后可以用navicat客户端等测试下连接是否可以成功</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Python-Python%E9%80%9F%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Python-Python%E9%80%9F%E8%AE%B0/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 10:09:03" itemprop="dateCreated datePublished" datetime="2024-07-14T10:09:03+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-12 14:45:16" itemprop="dateModified" datetime="2024-06-12T14:45:16+08:00">2024-06-12</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Pandas中指定数据类型</p>
<p>Pandas从excel文件中读取数据时候, 可以使用converter参数指定要使用转换函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> decimal <span class="token keyword">import</span> Decimal
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">def</span> <span class="token function">decimal_from_value</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Decimal<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> converters<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'sales'</span><span class="token punctuation">:</span> decimal_from_value<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token comment"># 还可以使用数字指定需要转换的列, 18-35列</span>
x <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">.</span>fromkey<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">,</span> decimal_from_value<span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> converters<span class="token operator">=</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在pandas中如果想一直使用 Decimal类型, 各种运算会收到限制, 直接使用sum()等函数, 会导致运算结果直接变成float类型, 想要保持Decimal类型, 可以使用apply()函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>另外, Decimal过程中使用除法, 除数如果为0, 会出现<code>InvalidOperation: [&lt;class &#39;decimal.DivisionUndefined&#39;&gt;]</code>异常, 避免次异常的办法是在运算的过程中判断除数是否为0</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">/</span> x<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">else</span> Decimal<span class="token punctuation">(</span><span class="token string">'NaN'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>$\delta$</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Python-Python%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Python-Python%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 10:08:33" itemprop="dateCreated datePublished" datetime="2024-07-14T10:08:33+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-04 11:03:48" itemprop="dateModified" datetime="2024-04-04T11:03:48+08:00">2024-04-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Python-知识"><a href="#Python-知识" class="headerlink" title="Python 知识"></a>Python 知识</h2><p>[TOC]</p>
<h3 id="标准数据类型"><a href="#标准数据类型" class="headerlink" title="标准数据类型"></a>标准数据类型</h3><h4 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h4><h5 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h5><p>int</p>
<p>bool</p>
<h5 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h5><p>float</p>
<h5 id="复数"><a href="#复数" class="headerlink" title="复数"></a>复数</h5><p>complex</p>
<h4 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h4><h5 id="不可变序列"><a href="#不可变序列" class="headerlink" title="不可变序列"></a>不可变序列</h5><p>str</p>
<p>bytes</p>
<p>tuple</p>
<h5 id="可变序列"><a href="#可变序列" class="headerlink" title="可变序列"></a>可变序列</h5><p>bytesarray</p>
<p>list</p>
<h4 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h4><p>dict</p>
<h4 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h4><p>set</p>
<p>forzenset</p>
<h4 id="可调用类型"><a href="#可调用类型" class="headerlink" title="可调用类型"></a>可调用类型</h4><h5 id="用户自定义函数"><a href="#用户自定义函数" class="headerlink" title="用户自定义函数"></a>用户自定义函数</h5><h5 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h5><h5 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h5><h5 id="协程函数"><a href="#协程函数" class="headerlink" title="协程函数"></a>协程函数</h5><h5 id="异步生成器函数"><a href="#异步生成器函数" class="headerlink" title="异步生成器函数"></a>异步生成器函数</h5><h5 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h5><h5 id="内置方法"><a href="#内置方法" class="headerlink" title="内置方法"></a>内置方法</h5><h5 id="类"><a href="#类" class="headerlink" title="类"></a>类</h5><p>作为工厂来创建自身的实例</p>
<h5 id="类实例"><a href="#类实例" class="headerlink" title="类实例"></a>类实例</h5><h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><p>模块</p>
<h4 id="文件对象"><a href="#文件对象" class="headerlink" title="文件对象"></a>文件对象</h4><h4 id="类型对象"><a href="#类型对象" class="headerlink" title="类型对象"></a>类型对象</h4><p>type, 表示各种对象的类型</p>
<h4 id="空对象"><a href="#空对象" class="headerlink" title="空对象"></a>空对象</h4><p>None</p>
<h4 id="省略符对象"><a href="#省略符对象" class="headerlink" title="省略符对象"></a>省略符对象</h4><p>Ellipsis</p>
<h4 id="未实现对象"><a href="#未实现对象" class="headerlink" title="未实现对象"></a>未实现对象</h4><p>NotImplemented</p>
<h4 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h4><p>更像是实现一定接口的通用抽象的东西</p>
<p><code>container.__iter__()</code></p>
<p><code>iterator.__iter__()</code></p>
<p><code>iterator.__next__()</code></p>
<p>generator, 可以用来循环迭代</p>
<h4 id="上下文管理器"><a href="#上下文管理器" class="headerlink" title="上下文管理器"></a>上下文管理器</h4><p>更像是实现一定接口的通用抽象的东西</p>
<p><code>contextmanager.__enter__()</code></p>
<p><code>ontextmanager.__exit__(*exc_type*, *exc_val*, *exc_tb*)</code></p>
<p>可以在这些对象的某些动作运行前后实现特定功能</p>
<p>如file_like对象的打开写入保存这些可以用with 关键字来调用</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 10:08:23" itemprop="dateCreated datePublished" datetime="2024-07-14T10:08:23+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-05-11 19:41:19" itemprop="dateModified" datetime="2024-05-11T19:41:19+08:00">2024-05-11</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="数据库相关知识"><a href="#数据库相关知识" class="headerlink" title="数据库相关知识"></a>数据库相关知识</h1><p>[TOC]</p>
<h2 id="1-MariaDB-MySQL-篇"><a href="#1-MariaDB-MySQL-篇" class="headerlink" title="1. MariaDB / MySQL 篇"></a>1. MariaDB / MySQL 篇</h2><p>以MariaDB为主, MySQL的内容差不多</p>
<h3 id="1-MariaDB安装与配置"><a href="#1-MariaDB安装与配置" class="headerlink" title="1. MariaDB安装与配置"></a>1. MariaDB安装与配置</h3><ol>
<li>官网下载符合自己系统的安装包, 点击下一步安装</li>
<li>将MariaDB的安装路径下\bin目录添加导Path环境变量</li>
<li></li>
</ol>
<h3 id="2-命令行连接到数据库"><a href="#2-命令行连接到数据库" class="headerlink" title="2. 命令行连接到数据库"></a>2. 命令行连接到数据库</h3><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">mariadb -u username -p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>username</code>替换为自己数据库的用户名, 回车后会提示输入密码</p>
<h3 id="3-创建新用户"><a href="#3-创建新用户" class="headerlink" title="3. 创建新用户"></a>3. 创建新用户</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'username'</span> @ <span class="token string">'localhost'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'password'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="4-授予用户权限"><a href="#4-授予用户权限" class="headerlink" title="4. 授予用户权限"></a>4. 授予用户权限</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">privileges</span> <span class="token keyword">ON</span> databasename<span class="token punctuation">.</span>tablename <span class="token keyword">TO</span> <span class="token string">'username'</span><span class="token variable">@'host'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>privileges:  可以是SELECT, INSERT, UPDATE, DELETE等权限, 可以一个或多个, 或者用ALL表示所有权限</li>
<li>datebasename: 数据库名</li>
<li>tablename: 表名</li>
<li>username: 用户名</li>
<li>host: 主机名</li>
</ul>
<h3 id="5-创建数据库"><a href="#5-创建数据库" class="headerlink" title="5: 创建数据库"></a>5: 创建数据库</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>db_name</code> 为要创建的数据库名</p>
<h3 id="6-切换到指定数据库"><a href="#6-切换到指定数据库" class="headerlink" title="6: 切换到指定数据库"></a>6: 切换到指定数据库</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">USE</span> db_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="7-创建表"><a href="#7-创建表" class="headerlink" title="7: 创建表"></a>7: 创建表</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="pgsql"><a href="#pgsql" class="headerlink" title="pgsql"></a>pgsql</h1>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 10:08:01" itemprop="dateCreated datePublished" datetime="2024-07-14T10:08:01+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-25 08:40:29" itemprop="dateModified" datetime="2024-06-25T08:40:29+08:00">2024-06-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="1-Python与Excel"><a href="#1-Python与Excel" class="headerlink" title="1. Python与Excel"></a>1. Python与Excel</h4><p>常用的Excel库<code>openpyxl</code>, <code>xlrd</code>, <code>xlrw</code></p>
<h5 id="openpyxl"><a href="#openpyxl" class="headerlink" title="openpyxl"></a>openpyxl</h5><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>




      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 10:07:41" itemprop="dateCreated datePublished" datetime="2024-07-14T10:07:41+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-25 08:40:32" itemprop="dateModified" datetime="2024-06-25T08:40:32+08:00">2024-06-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Linux-常用命令"><a href="#Linux-常用命令" class="headerlink" title="Linux 常用命令"></a>Linux 常用命令</h2><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><ul>
<li><p>df 磁盘空间</p>
</li>
<li><p>free 内存</p>
</li>
<li><p>exit 结束</p>
</li>
</ul>
<h3 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h3><ul>
<li><p>pwd 当前目录</p>
</li>
<li><p>ls 目录内容</p>
<ul>
<li>-a 列出所有内容(包含隐藏的)</li>
<li>-l 长格式</li>
<li>-t 按修改时间排序</li>
</ul>
</li>
<li><p>cd 切换到指定目录</p>
</li>
<li><p>file 确定文件类型</p>
</li>
<li><p>less 翻看文本文件</p>
</li>
<li><p>ln 软链接</p>
</li>
<li><p>mkdir</p>
</li>
<li><p>cp</p>
</li>
<li><p>mv</p>
</li>
<li><p>rm</p>
</li>
</ul>
<h3 id="查看服务"><a href="#查看服务" class="headerlink" title="查看服务"></a>查看服务</h3><p>/etc/init.d/中存放有可执行脚本的服务:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> SCRIPT start    <span class="token comment"># 启动服务</span>
<span class="token function">service</span> SCRIPT stop     <span class="token comment"># 停止服务</span>
<span class="token function">service</span> SCRIPT restart  <span class="token comment"># 重启服务</span>
<span class="token function">service</span> SCRIPT status   <span class="token comment"># 查看状态服务</span>
<span class="token function">service</span> --status-all <span class="token comment"># 查看所有系统服务</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>systemd式服务</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start servicename <span class="token comment"># 启动服务</span>
systemctl stop servicename <span class="token comment"># 停止服务</span>
systemctl restart servicename <span class="token comment"># 重启服务</span>
systemctl status servicename <span class="token comment"># 查看服务状态</span>
systemctl <span class="token comment"># 查看所有服务</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>MariaDB, Nginx都可以通过此种方法执行各种操作</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> service_name <span class="token comment"># 查看服务进程</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ps查看进程状态, |管道符号把查询内容传给grep, 匹配出对应的服务名的进程</p>
<p>netstat 查看网络服务</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-%E7%BD%91%E7%AB%99%E5%BC%80%E5%8F%91-Django-Django/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-%E7%BD%91%E7%AB%99%E5%BC%80%E5%8F%91-Django-Django/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 10:07:29" itemprop="dateCreated datePublished" datetime="2024-07-14T10:07:29+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-25 08:40:31" itemprop="dateModified" datetime="2024-06-25T08:40:31+08:00">2024-06-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Django-相关内容"><a href="#Django-相关内容" class="headerlink" title="Django 相关内容"></a>Django 相关内容</h1><p>[TOC]</p>
<h2 id="Part-1-运行环境等问题"><a href="#Part-1-运行环境等问题" class="headerlink" title="Part 1. 运行环境等问题"></a>Part 1. 运行环境等问题</h2><h3 id="1-Django-中无法加载环境变量问题"><a href="#1-Django-中无法加载环境变量问题" class="headerlink" title="1. Django 中无法加载环境变量问题"></a>1. Django 中无法加载环境变量问题</h3><p>暂时查不到解决办法, 应该是初级问题, 网上答案很诡异, 都是在配置Django的环境变量, 完全get不到点</p>
<p>每次命令行要重启下</p>
<h3 id="2-MySQL-真正UTF-8支持"><a href="#2-MySQL-真正UTF-8支持" class="headerlink" title="2.  MySQL 真正UTF-8支持"></a>2.  MySQL 真正UTF-8支持</h3><ol>
<li><p>设置数据库编码为<code>utf8mb4</code>, 如果表已创建, 可以使用以下SQL语句更改</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">CONVERT</span> <span class="token keyword">TO</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>设置 Django 的 setting.py 文件中 Databse设置, 使连接也为真正UTF8, 加一个 OPTIONS 选项, 在里面设置编码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">DATABASES <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string">'ENGINE'</span><span class="token punctuation">:</span> <span class="token string">'django.db.backends.mysql'</span><span class="token punctuation">,</span>
        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'dj'</span><span class="token punctuation">,</span>
        <span class="token string">'USER'</span><span class="token punctuation">:</span> USERNAME<span class="token punctuation">,</span>
        <span class="token string">'PASSWORD'</span><span class="token punctuation">:</span> PASSWORD<span class="token punctuation">,</span>
        <span class="token string">'HOST'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
        <span class="token string">'PORT'</span><span class="token punctuation">:</span> <span class="token string">'3306'</span><span class="token punctuation">,</span>
        <span class="token string">'OPTIONS'</span> <span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token string">'charset'</span> <span class="token punctuation">:</span> <span class="token string">'utf8mb4'</span> <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="3-网络部署问题"><a href="#3-网络部署问题" class="headerlink" title="3.  网络部署问题"></a>3.  网络部署问题</h3><p>工作流程:</p>
<ol>
<li>本地写代码, git上传到搭建的git服务器上</li>
<li>服务器上安装Django虚拟环境, 安装uWSGI库, 安装Nginx, 用来跑项目</li>
</ol>
<p>局域网搭建服务器流程:</p>
<ol>
<li>Ubuntu 安装</li>
<li>ssh 安装</li>
<li>安装pip, virtualenv</li>
<li>建立Python虚拟环境, 安装Django, uWSGI等, 配置uWSGI相应文件, 并运行测试下</li>
<li>安装Nginx, 配置Nginx指向uWSGI及Django项目等, 测试运行</li>
<li>外网访问: setting.py中设置<code>ALLOWD_HOST = [&#39;*&#39;]</code>, IPV6可以直接外网访问</li>
</ol>
<p>UWSGI配置其他, Nginx安装与配置这些可以展开写一些内容</p>
<p>局域网搭建Git服务器也可以展开写一些</p>
<h4 id="uWSGI-安装与配置"><a href="#uWSGI-安装与配置" class="headerlink" title="uWSGI 安装与配置"></a>uWSGI 安装与配置</h4><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><h5 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h5><p>启动, 停止, 重启</p>
<h4 id="Nginx-安装与配置"><a href="#Nginx-安装与配置" class="headerlink" title="Nginx 安装与配置"></a>Nginx 安装与配置</h4><h5 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h5><h5 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h5><h5 id="常用命令-1"><a href="#常用命令-1" class="headerlink" title="常用命令"></a>常用命令</h5><p>启动, 停止, 重启</p>
<h4 id="MariaDB-安装与配置"><a href="#MariaDB-安装与配置" class="headerlink" title="MariaDB 安装与配置"></a>MariaDB 安装与配置</h4><h5 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h5><h5 id="配置-2"><a href="#配置-2" class="headerlink" title="配置"></a>配置</h5><h5 id="常用命令-2"><a href="#常用命令-2" class="headerlink" title="常用命令"></a>常用命令</h5><p>启动, 停止, 重启</p>
<h4 id="Git-服务器安装与相关配置"><a href="#Git-服务器安装与相关配置" class="headerlink" title="Git 服务器安装与相关配置"></a>Git 服务器安装与相关配置</h4><h5 id="服务器上安装Git"><a href="#服务器上安装Git" class="headerlink" title="服务器上安装Git"></a>服务器上安装Git</h5><h5 id="设置专用的Git账户"><a href="#设置专用的Git账户" class="headerlink" title="设置专用的Git账户"></a>设置专用的Git账户</h5><p>Django开发流程:</p>
<ol>
<li><p>服务器端初始化一个git仓库</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>设置仓库接受代码提交</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> config receive.denyCurrentBranch ignore<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>设置服务器仓库git提交操作后自动更新的/hook/post-receive. 并且注意改变为可执行模式</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">unset</span> GIT_DIR
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token function">git</span> checkout <span class="token parameter variable">-f</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>本地编辑代码后push到服务器(注意先在本地收集静态文件)</p>
</li>
</ol>
<h2 id="Part-2-Django-框架中问题"><a href="#Part-2-Django-框架中问题" class="headerlink" title="Part 2: Django 框架中问题"></a>Part 2: Django 框架中问题</h2><h3 id="1-Models-模型"><a href="#1-Models-模型" class="headerlink" title="1. Models 模型"></a>1. Models 模型</h3><ol>
<li>编辑 <code>models.py</code> 文件, 改变模型</li>
<li>运行 <code>python manage.py makemigrations</code> 为模型的改变生成迁移文件</li>
<li>运行 <code>python manage.py migrate </code> 来应用数据库迁移</li>
</ol>
<p>使用Python的数据模型对象可以用filter或get返回对象, filter更像常规的用法, 返回空列表或者对应的数据, get返回可能会报错, 并且通过属性+双下划线的方式来标识某些条件, 在我看来并不优雅, 看似小聪明, 感觉并不利于维护</p>
<h3 id="2-模板系统"><a href="#2-模板系统" class="headerlink" title="2. 模板系统"></a>2. 模板系统</h3><p>模板系统有点啰嗦, 已经是在对应的app的templates目录下了, 还要在建一个对应的名字的文件夹来区分命名空间</p>
<h2 id="Par"><a href="#Par" class="headerlink" title="Par"></a>Par</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-%E7%BD%91%E7%AB%99%E5%BC%80%E5%8F%91-Flask-Flask%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-%E7%BD%91%E7%AB%99%E5%BC%80%E5%8F%91-Flask-Flask%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-07-14 10:06:55 / 修改时间：10:06:12" itemprop="dateCreated datePublished" datetime="2024-07-14T10:06:55+08:00">2024-07-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Flask相关知识"><a href="#Flask相关知识" class="headerlink" title="Flask相关知识"></a>Flask相关知识</h2><h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><ul>
<li>自带视图</li>
<li></li>
</ul>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><ol>
<li>装饰器</li>
<li>单独文件统一指定</li>
</ol>
<h3 id="数据模型"><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h3><p>Flask_SQLAlchemy:</p>
<ul>
<li>配置对应的数据库URL</li>
<li>定义数据模型</li>
<li>在应用初始化中创建对应的表</li>
<li>在视图中使用数据库对象方法来操作数据库</li>
</ul>
<p>Flask_Migrate:</p>
<ul>
<li>初始化<code>flask db init</code></li>
<li>创建迁移脚本<code>flask db migrate</code></li>
<li>将迁移应用到数据库 <code>flask db upgrade</code></li>
</ul>
<h3 id="模板系统"><a href="#模板系统" class="headerlink" title="模板系统"></a>模板系统</h3><p>jinjia2模板系统, 全栈开发的话可能有用, 如果注重全段页面的话还是需要专门的前端人员.</p>
<h3 id="蓝图"><a href="#蓝图" class="headerlink" title="蓝图"></a>蓝图</h3><p>不同的应用独立出一个不同的蓝图, 然后在挂在到某个URL前缀上</p>
<h3 id="内部流程"><a href="#内部流程" class="headerlink" title="内部流程"></a>内部流程</h3><p>客户端请求 –请求对象-&gt; Flask –查找请求的URL-&gt; 视图 –响应-&gt; </p>
<p>应用上下文:</p>
<ul>
<li>current_app</li>
<li>g</li>
</ul>
<p>请求上下文:</p>
<ul>
<li>request</li>
<li>session</li>
</ul>
<p>钩子, 像是不同情况的触发器, 请求发生前, 发生后等, 触发这个就做某些事</p>
<p>Hooks:</p>
<ul>
<li>before_request</li>
<li>before_first_request</li>
<li>after_request</li>
<li>teardown_request</li>
</ul>
<h3 id="非核心内容"><a href="#非核心内容" class="headerlink" title="非核心内容"></a>非核心内容</h3><p>配置文件:</p>
<ul>
<li>单独配置文件</li>
<li>使用类继承来区分不同的配置, 开发, 测试, 生产环境</li>
<li>重要信息从环境变量中获取</li>
</ul>
<p>单元测试:</p>
<ul>
<li>可以使用标准库的unittest来进行单元测试</li>
</ul>
<h3 id="常用Flask插件"><a href="#常用Flask插件" class="headerlink" title="常用Flask插件"></a>常用Flask插件</h3><p>数据库:</p>
<ul>
<li>Flask_SQLAlchemy</li>
<li>Flask_Migrate</li>
</ul>
<p>前端:</p>
<ul>
<li>Flask_Bootstrap</li>
<li>Flask_Markdown</li>
<li>Flask_Pagedown</li>
</ul>
<p>表单系统:</p>
<ul>
<li>Flask_WTF</li>
</ul>
<p>身份验证:</p>
<ul>
<li>Flask_Login</li>
<li>Flask_HTTPAuth 验证身份</li>
</ul>
<p>邮件系统:</p>
<ul>
<li>Flask_Mail</li>
</ul>
<p>如何异步上传</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2023/05/27/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-openEuler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-openEuler/" class="post-title-link" itemprop="url">虚拟机下openEuler的安装与一些常见服务部署</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-05-27 21:15:00" itemprop="dateCreated datePublished" datetime="2023-05-27T21:15:00+08:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-15 21:37:23" itemprop="dateModified" datetime="2024-07-15T21:37:23+08:00">2024-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">编程开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="虚拟机下openEuler的安装与一些常见服务部署"><a href="#虚拟机下openEuler的安装与一些常见服务部署" class="headerlink" title="虚拟机下openEuler的安装与一些常见服务部署"></a>虚拟机下openEuler的安装与一些常见服务部署</h1><h2 id="网络问题"><a href="#网络问题" class="headerlink" title="网络问题"></a>网络问题</h2><p>NAT模式下, 虚拟网卡VMnet8相当于一个虚拟的路由器, 分出相应的子网</p>
<p>某些情网络配置并不正确, 需要将网关等配置与虚拟网卡保持一致</p>
<p>修改对应网卡配置文件<code>sudo vim /etc/sysconfig/network-scripts/ifcfg-ens33</code>:</p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">TYPE</span><span class="token punctuation">=</span><span class="token value attr-value">Ethernet</span>
<span class="token key attr-name">BOOTPROTO</span><span class="token punctuation">=</span><span class="token value attr-value">static</span>
<span class="token key attr-name">NAME</span><span class="token punctuation">=</span><span class="token value attr-value">ens33</span>
<span class="token key attr-name">DEVICE</span><span class="token punctuation">=</span><span class="token value attr-value">ens33</span>
<span class="token key attr-name">ONBOOT</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPADDR</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.101.130</span>
<span class="token key attr-name">NETMASK</span><span class="token punctuation">=</span><span class="token value attr-value">255.255.255.0</span>
<span class="token key attr-name">GATEWAY</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.101.2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<img src="/2023/05/27/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91-Linux-openEuler/%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1VMnet8%E4%BF%A1%E6%81%AF.png" class="" title="虚拟网卡VMnet8信息">

<p><code>IPADDR</code>: 服务器的地址, 选择一个合适地址, 保证和虚拟网卡在一个网段就好<br><code>GATEWAY</code>: 网关, 一般为虚拟网卡同一网卡的第2个地址, 例子中为<code>192.168.101.2</code></p>
<p>安装好的虚拟机, 虚拟网卡的信息应该类似图中所示, 如果缺少部分, 需要在win下配置对应的信息</p>
<h2 id="uWsgi配置与nginx代理"><a href="#uWsgi配置与nginx代理" class="headerlink" title="uWsgi配置与nginx代理"></a>uWsgi配置与nginx代理</h2><p><code>uWsgi</code> 安装过程没有太多坑, <code>pip install uwsgi</code>一般会遇到一些问题, 编译错误的根据提示下载<code>gcc</code>或者<code>python-dev</code>之类的就可以解决</p>
<p>安装后可以简单的配置, 先来一个简单的配置文件</p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">uwsgi</span><span class="token punctuation">]</span></span>
<span class="token comment">#uwsgi启动时，所使用的地址和端口（这个是http协议的）</span>
<span class="token comment">#http=0.0.0.0:5000</span>
<span class="token comment">#指向网站目录</span>
<span class="token key attr-name">chdir</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/myexam/</span>
<span class="token comment">#python 启动程序文件</span>
<span class="token key attr-name">wsgi-file</span><span class="token punctuation">=</span><span class="token value attr-value">wsgi.py</span>
<span class="token comment">#python 程序内用以启动的application 变量名</span>
<span class="token key attr-name">callable</span><span class="token punctuation">=</span><span class="token value attr-value">app</span>
<span class="token comment">#处理器数</span>
<span class="token key attr-name">processes</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
<span class="token comment">#线程数</span>
<span class="token key attr-name">threads</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
<span class="token comment"># uwsgi pid 号</span>
<span class="token key attr-name">pidfile</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/uwsgi/uwsgi.pid</span>

<span class="token comment"># 重启的时候使用的 pid 号</span>
<span class="token key attr-name">touch-reload</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/uwsgi/uwsgi.pid</span>

<span class="token comment"># unix socket和TCP socket配置, 在nginx可以使用这两个socket</span>
<span class="token key attr-name">socket</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/uwsgi/uwsgi.sock</span>
<span class="token key attr-name">socket</span><span class="token punctuation">=</span><span class="token value attr-value">0.0.0.0:5000</span>
<span class="token key attr-name">chomod-socket</span><span class="token punctuation">=</span><span class="token value attr-value">666</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行<code>/home/miao/.venv/myflask/bin/uwsgi --ini uwsgi.ini</code>, 看是否可以运行</p>
<p>每次手动运行显然不够优雅, 配置好这个再配置对应的开机自启</p>
<p><code>Nginx</code>中相应配置, 文件位置一般在<code>/etc/nginx/nginx.conf</code>:</p>
<p>第一种模式, 单机, 直接再<code>server</code>配置下增加<code>location</code>的配置</p>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx">...
...
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">listen</span>       [::]:80</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  192.168.101.130</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">root</span>         /usr/share/nginx/html</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">&#123;</span>
        <span class="token directive"><span class="token keyword">include</span> uwsgi_params</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">uwsgi_pass</span> unix:///home/miao/uwsgi/uwsgi.sock</span><span class="token punctuation">;</span>
        <span class="token comment"># uwsgi_pass 127.0.0.1:5000;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
...
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>uwsgi_pass</code> 指向之前在<code>uwsgi.ini</code>中配置的<code>unix socket</code>或者<code>TCP socket</code></p>
<p>第二种模式, 集群, 在<code>server</code>外添加<code>upstream</code></p>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">&#123;</span>

    ...
    ...
    <span class="token directive"><span class="token keyword">upstream</span> uwsgicluster</span> <span class="token punctuation">&#123;</span>
        <span class="token directive"><span class="token keyword">server</span> unix:///home/miao/uwsgi/uwsgi.sock</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:5000</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">&#123;</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">listen</span>       [::]:80</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  192.168.101.130</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">root</span>         /usr/share/nginx/html</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">&#123;</span>
            <span class="token directive"><span class="token keyword">include</span> uwsgi_params</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">uwsgi_pass</span> uwsgicluster</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    ...
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里将在<code>upstream</code>中配置集群, <code>server</code>指向对应的<code>socket</code>, 在<code>location</code>中将<code>uwsgi_pass</code>指向集群<code>uwsgicluster</code></p>
<p>这些配置后可能遇到的问题:</p>
<ol>
<li><code>nginx</code>启动后, 无法正常访问页面</li>
</ol>
<p>关闭防火墙试一试</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl stop firewalld
<span class="token function">sudo</span> systemctl disable firewalld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="2">
<li><code>nginx</code>可以启动正常运行, 但<code>uWsgi</code>启动后, 无法被<code>nginx</code>代理</li>
</ol>
<p>可能是权限问题, <code>nginx</code>无法读取对应的<code>unix socket</code>, 单机可以使用, 速度应该会更好一点</p>
<p>注意在<code>uwsgi.ini</code>添加对应配置, 升级权限</p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">chmod-socket</span><span class="token punctuation">=</span><span class="token value attr-value">666</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>修改<code>/etc/nginx/nginx.conf</code>, 修改用户为可访问的用户</p>
<pre class="line-numbers language-conf" data-language="conf"><code class="language-conf"># user nginx;
user miao;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<h2 id="uWsgi使用systemd方式自启动"><a href="#uWsgi使用systemd方式自启动" class="headerlink" title="uWsgi使用systemd方式自启动"></a><code>uWsgi</code>使用<code>systemd</code>方式自启动</h2><p>添加配置文件<code>/etc/systemd/system/uwsgi.service</code></p>
<pre class="line-numbers language-systemd" data-language="systemd"><code class="language-systemd"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Unit</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Description</span><span class="token punctuation">=</span><span class="token value attr-value">uwsgi</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">syslog.target</span>

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Service</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Type</span><span class="token punctuation">=</span><span class="token value attr-value">notify</span>
<span class="token key attr-name">ExecStart</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/.venv/myflask/bin/uwsgi --ini /home/miao/uwsgi/uwsgi.ini</span>
<span class="token key attr-name">ExecStop</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/.venv/myflask/bin/uwsgi --stop /home/miao/uwsgi/uwsgi.pid</span>
<span class="token key attr-name">ExecReload</span><span class="token punctuation">=</span><span class="token value attr-value">/home/miao/.venv/myflask/bin/uwsgi --reload /home/miao/uwsgi/uwsgi.pid</span>
<span class="token key attr-name">User</span><span class="token punctuation">=</span><span class="token value attr-value">miao</span>
<span class="token key attr-name">Group</span><span class="token punctuation">=</span><span class="token value attr-value">miao</span>
<span class="token key attr-name">Restart</span><span class="token punctuation">=</span><span class="token value attr-value">on-failure</span>
<span class="token key attr-name">KillSignal</span><span class="token punctuation">=</span><span class="token value attr-value">SIGQUIT</span>
<span class="token key attr-name">StandardError</span><span class="token punctuation">=</span><span class="token value attr-value">syslog</span>
<span class="token key attr-name">NotifyAccess</span><span class="token punctuation">=</span><span class="token value attr-value">all</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Install</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">WantedBy</span><span class="token punctuation">=</span><span class="token value attr-value">multi-user.target</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>配置好后, 使用下面命令重新加载</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>启动<code>uwsgi</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start uwsgi <span class="token comment"># 启动</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> uwsgi <span class="token comment"># 开机自启</span>
<span class="token function">sudo</span> systemctl stop uwsgi <span class="token comment"># 关闭</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<p>如果出现错误, 可以查看是系统日志文件<code>/var/log/message</code>, 如果出现<code>Permission denied</code>的错误, 大概率是<code>SElinux</code>在阻止的问题</p>
<p>关闭<code>SElinux</code>试一试, <code>vim /etc/selinux/config</code></p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># This file controls the state of SELinux on the system.</span>
<span class="token comment"># SELINUX= can take one of these three values:</span>
<span class="token comment">#     enforcing - SELinux security policy is enforced.</span>
<span class="token comment">#     permissive - SELinux prints warnings instead of enforcing.</span>
<span class="token comment">#     disabled - No SELinux policy is loaded.</span>
<span class="token key attr-name">SELINUX</span><span class="token punctuation">=</span><span class="token value attr-value">disabled</span>
<span class="token comment"># SELINUXTYPE= can take one of these three values:</span>
<span class="token comment">#     targeted - Targeted processes are protected,</span>
<span class="token comment">#     minimum - Modification of targeted policy. Only selected processes are protected.</span>
<span class="token comment">#     mls - Multi Level Security protection.</span>
<span class="token key attr-name">SELINUXTYPE</span><span class="token punctuation">=</span><span class="token value attr-value">targeted</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>设置<code>SELINUX=disabled</code></p>
<p>重新启动系统后生效</p>
<h2 id="ssh远程登陆use-ssh-key"><a href="#ssh远程登陆use-ssh-key" class="headerlink" title="ssh远程登陆use ssh-key"></a>ssh远程登陆use ssh-key</h2><ol>
<li><p>本地生成密钥文件</p>
 <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-keygen <span class="token parameter variable">-t</span> rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p> 这一步会在<code>~/.ssh/</code>目录下生成公钥和私钥文件</p>
</li>
<li><p>将<code>~/.ssh/</code>下的公钥文件<code>id_rsa.pub</code>复制到远程服务器</p>
</li>
</ol>
<pre><code><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">ssh-copy-id -i ~&#x2F;.ssh&#x2F;id_rsa.pub miao@192.168.101.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

成功后, 可以在尝试登录, 现在就不需要输入密码了
</code></pre>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangmaio.site/2020/05/08/%E6%97%A5%E5%B8%B8%E5%8A%9E%E5%85%AC-%E5%B7%A5%E5%85%B7%E6%8A%80%E5%B7%A7-2020-05-08-%E8%AE%A1%E7%AE%97%E5%99%A8%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7MC-MR-M-M-MS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Wang Miao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="大喵小站">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 大喵小站">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/08/%E6%97%A5%E5%B8%B8%E5%8A%9E%E5%85%AC-%E5%B7%A5%E5%85%B7%E6%8A%80%E5%B7%A7-2020-05-08-%E8%AE%A1%E7%AE%97%E5%99%A8%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7MC-MR-M-M-MS/" class="post-title-link" itemprop="url">计算器的小技巧MC MR M+ M- MS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-05-08 13:01:15" itemprop="dateCreated datePublished" datetime="2020-05-08T13:01:15+08:00">2020-05-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-04-22 16:32:14" itemprop="dateModified" datetime="2023-04-22T16:32:14+08:00">2023-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%A5%E5%B8%B8%E5%8A%9E%E5%85%AC/" itemprop="url" rel="index"><span itemprop="name">日常办公</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%A5%E5%B8%B8%E5%8A%9E%E5%85%AC/%E5%B7%A5%E5%85%B7%E6%8A%80%E5%B7%A7/" itemprop="url" rel="index"><span itemprop="name">工具技巧</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>财务工作中我们经常要用到计算器, 计算器上的M键有记忆功能, 我们可以利用这些小技巧来加速我们的计算, 就让我们看看它们都有什么作用吧</p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/05/08/%E6%97%A5%E5%B8%B8%E5%8A%9E%E5%85%AC-%E5%B7%A5%E5%85%B7%E6%8A%80%E5%B7%A7-2020-05-08-%E8%AE%A1%E7%AE%97%E5%99%A8%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7MC-MR-M-M-MS/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wang Miao</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"weot","repo":"weot.github.io","client_id":"584128d465c8539b3ac8","client_secret":"f698eefe1358c9cff6b754d137d23c9709875c78","admin_user":"Weot","distraction_free_mode":true,"language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"d1546d731a9f30cc80127d57142a482b"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
